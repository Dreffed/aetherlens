# Fix Documentation
Date: 2025-10-24 14:30

## Issue: Docker Image Not Available for Testing

### Problem Description
The GitHub CI Pipeline was failing at the "Test Docker image" step with the following error:

```
Unable to find image 'aetherlens/home:test' locally
docker: Error response from daemon: pull access denied for aetherlens/home,
repository does not exist or may require 'docker login': denied: requested
access to the resource is denied
```

### Root Cause
When using `docker/build-push-action@v5` with Docker Buildx, the built image is not automatically loaded into the local Docker daemon. The action has `push: false` set, which means:
- The image is built using BuildKit
- The image is NOT pushed to a registry
- The image is NOT loaded into the local Docker daemon by default

When the subsequent test step tried to run `docker run --rm aetherlens/home:test python --version`, Docker couldn't find the image locally and attempted to pull it from Docker Hub, which failed because the repository doesn't exist there (or requires authentication).

### Solution
Added `load: true` parameter to the `docker/build-push-action@v5` configuration in `.github/workflows/ci.yml`.

### Changes Made

**File:** `.github/workflows/ci.yml` (line 147)

**Before:**
```yaml
      - name: Build Docker image
        uses: docker/build-push-action@v5
        with:
          context: .
          file: ./docker/Dockerfile
          push: false
          tags: aetherlens/home:test
          cache-from: type=gha
          cache-to: type=gha,mode=max
```

**After:**
```yaml
      - name: Build Docker image
        uses: docker/build-push-action@v5
        with:
          context: .
          file: ./docker/Dockerfile
          push: false
          load: true  # <-- Added this line
          tags: aetherlens/home:test
          cache-from: type=gha
          cache-to: type=gha,mode=max
```

### Explanation
The `load: true` parameter tells Docker Buildx to export the built image to the Docker daemon's image store after building. This makes the image available for:
- Subsequent `docker run` commands
- Local testing in the CI pipeline
- Inspection with `docker images`

### Testing
After this fix, the CI pipeline should:
1. Build the Docker image successfully ✅
2. Load it into the local Docker daemon ✅
3. Run the test command `docker run --rm aetherlens/home:test python --version` ✅

### References
- [Docker Build Push Action Documentation](https://github.com/docker/build-push-action)
- [Docker Buildx Documentation](https://docs.docker.com/buildx/working-with-buildx/)

### Related Issues
- Error documented in: `errors/20251024.006.errors.md`

### Notes
- This is a common gotcha when migrating from classic Docker builds to Docker Buildx
- When `push: false`, you must explicitly set `load: true` to make images available locally
- When `push: true`, the `load` parameter is typically not needed as the image goes to the registry
