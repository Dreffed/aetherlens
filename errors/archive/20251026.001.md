# GitHub Actions Errors

## Summary

| Job | Status |
|-----|--------|
| Lint | failure |
| Unit Tests | failure |
| Integration Tests | failure |
| Security Tests | success |
| Quality Tests | failure |

❌ Some tests failed. Please review the results above.

## Detail

### Lint

`*FAILED*`

- *Run ruff*

```
Run ruff check src/ tests/
S105 Possible hardcoded password assigned to: "token_type"
  --> src/aetherlens/api/routes/auth.py:29:23
   |
27 |     access_token: str
28 |     refresh_token: str
29 |     token_type: str = "bearer"
   |                       ^^^^^^^^
30 |     expires_in: int
   |

S608 Possible SQL injection vector through string-based query construction
  --> src/aetherlens/api/routes/devices.py:53:17
   |
52 |           # Get devices
53 |           query = f"""
   |  _________________^
54 | |             SELECT device_id, name, type, manufacturer, model, location,
55 | |                    capabilities, configuration, metadata, status,
56 | |                    created_at, updated_at
57 | |             FROM devices
58 | |             {where_clause}
59 | |             ORDER BY created_at DESC
60 | |             LIMIT $1 OFFSET $2
61 | |         """
   | |___________^
62 |
63 |           rows = await conn.fetch(query, *params)
   |

Found 2 errors.
Error: Process completed with exit code 1.
```

### Unit Tests

`*FAILED*`

- *Check coverage trhreshold*

```
Run COVERAGE=$(python -c "import xml.etree.ElementTree as ET; tree = ET.parse('coverage.xml'); root = tree.getroot(); print(root.attrib['line-rate'])")
Coverage: 47.0200%
❌ Coverage 47.0200% is below 70% threshold
Error: Process completed with exit code 1.
```

### Integration Tests

`*FAILED*`

- *Integration Tests*

```
...
============ 14 failed, 10 passed, 24 warnings, 57 errors in 16.12s ============
Error: Process completed with exit code 1.
```

### Security Tests

`*PASSED*`

### Quality Tests

`*FAILED*`

- *Run Quality tests*

```
Run pytest tests/quality/ -v -m quality
============================= test session starts ==============================
platform linux -- Python 3.11.13, pytest-7.4.4, pluggy-1.6.0 -- /opt/hostedtoolcache/Python/3.11.13/x64/bin/python
cachedir: .pytest_cache
rootdir: /home/runner/work/aetherlens/aetherlens
configfile: pyproject.toml
plugins: anyio-4.11.0, asyncio-0.23.8, timeout-2.4.0, cov-5.0.0, mock-3.15.1
asyncio: mode=Mode.AUTO
collecting ... collected 0 items

=============================== warnings summary ===============================
../../../../../opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/formparsers.py:12
  /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/formparsers.py:12: PendingDeprecationWarning: Please use `import python_multipart` instead.
    import multipart

src/aetherlens/models/device.py:55
  /home/runner/work/aetherlens/aetherlens/src/aetherlens/models/device.py:55: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class DeviceResponse(DeviceBase):

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

---------- coverage: platform linux, python 3.11.13-final-0 ----------
Name                                    Stmts   Miss   Cover   Missing
----------------------------------------------------------------------
src/aetherlens/__init__.py                  3      0 100.00%
src/aetherlens/api/__init__.py              0      0 100.00%
src/aetherlens/api/database.py             25     14  44.00%   21-31, 35-41, 45-47
src/aetherlens/api/dependencies.py         26     17  34.62%   29-59, 75-81
src/aetherlens/api/logging.py              21      9  57.14%   56-81
src/aetherlens/api/main.py                 44     11  75.00%   33-44, 84-85, 105, 112
src/aetherlens/api/metrics.py              39     23  41.03%   46-69, 79-92
src/aetherlens/api/rate_limit.py           43     30  30.23%   20, 34-49, 56-59, 65-111
src/aetherlens/api/routes/__init__.py       0      0 100.00%
src/aetherlens/api/routes/auth.py          32     14  56.25%   51-88
src/aetherlens/api/routes/devices.py       72     55  23.61%   34-68, 84-102, 118-149, 170-203, 218-227
src/aetherlens/api/routes/health.py        57     34  40.35%   31-48, 53-71, 89-114, 125-134, 148
src/aetherlens/collection/__init__.py       0      0 100.00%
src/aetherlens/config.py                   25      0 100.00%
src/aetherlens/costs/__init__.py            0      0 100.00%
src/aetherlens/models/__init__.py           0      0 100.00%
src/aetherlens/models/device.py            45      3  93.33%   36-40
src/aetherlens/models/metric.py            31     31   0.00%   5-53
src/aetherlens/plugins/__init__.py          0      0 100.00%
src/aetherlens/security/__init__.py         0      0 100.00%
src/aetherlens/security/jwt.py             34     22  35.29%   33-44, 50-58, 73-86
src/aetherlens/security/passwords.py        7      4  42.86%   18-20, 34
----------------------------------------------------------------------
TOTAL                                     504    267  47.02%
Coverage HTML written to dir htmlcov
Coverage XML written to file coverage.xml

============================= 2 warnings in 0.32s ==============================
Error: Process completed with exit code 5.
```
### Test Summary

`*FAILED*`

- *Check test results*

```
Run echo "## Test Results Summary" >> $GITHUB_STEP_SUMMARY
Error: Process completed with exit code 1.
```